$('#mentoring_start').val('<%=params[:time_filter][:start_time]%>');
$('#assessment_start').val('<%=params[:time_filter][:start_time]%>');
$('#mentoring_till').val('<%=params[:time_filter][:end_time]%>');
$('#assessment_till').val('<%=params[:time_filter][:end_time]%>');

$('#chart_1').html('<%= escape_javascript(render("district_assessments_table")) %>');
$('#chart_2').html('<%= escape_javascript(render("district_mentorings_table")) %>');

$("table#district_assessments_dtable").dataTable( {
	"sDom": "<'row'<'span6'l><'span6'f>r>t<'row'<'span6'i><'span6'p>>",
	"sPaginationType": "bootstrap",
	"oLanguage": {"sLengthMenu": "_MENU_ records per page"},
	"aoColumnDefs": [{ "bSortable": false, "aTargets": [ 7 ] }],
	"aaSorting": [[2,'desc']],
	"bAutoWidth": false //I need this to fix a bug between bootstrap-tab.js and datatables. Good times...
	
} );

$("table#district_mentorings_dtable").dataTable( {
	"sDom": "<'row'<'span6'l><'span6'f>r>t<'row'<'span6'i><'span6'p>>",
	"sPaginationType": "bootstrap",
	"oLanguage": {"sLengthMenu": "_MENU_ records per page"},
	"aoColumnDefs": [{ "bSortable": false, "aTargets": [ 9 ] }],
	"aaSorting": [[5,'desc']],
	"bAutoWidth": false //I need this to fix a bug between bootstrap-tab.js and datatables. Good times...
} );

<% counter = 1 %>
<% for indicator in @assessment_indicators %>

	assessment_indicator_barchart_<%=counter%> = 0;
	assessment_indicator_scatterplot_<%=counter%> = 0;
	
	<% @cluster_sets.each_with_index {|set, index| %>		
		barchart_assessment_<%=counter%>_<%=(index+1)%> = function()
		{
			<%= render_chart_without_script indicator_combo_chart(set,indicator,@collection_names,1300,500,'automatic',true,60), 'barcharta'+counter.to_s+'_'+index.to_s %>
		}
		$('#barcharta<%=counter.to_s%>_<%=index%>').toggle();
		<%= render_chart_without_script indicator_combo_chart(set,indicator,@collection_names,1300,500,'automatic',true,60), 'barcharta'+counter.to_s+'_'+index.to_s %>
		$('#barcharta<%=counter.to_s%>_<%=index%>').toggle();
	<% } %>

	scatterplot_assessment_<%=(counter)%> = function()
	{
		<%= render_chart_without_script indicator_scatter_chart(@clusters,indicator, @collection_names), 'scattera'+counter.to_s %>
	}
	
	$('#scattera<%=counter.to_s%>').toggle();
	<%= render_chart_without_script indicator_scatter_chart(@clusters,indicator, @collection_names), 'scattera'+counter.to_s %>
	$('#scattera<%=counter.to_s%>').toggle();
<% counter += 1 %>
<% end %>

<% counter = 1 %>
<% for indicator in @mentoring_indicators %>

	mentoring_indicator_barchart_<%=counter%> = 0;
	mentoring_indicator_scatterplot_<%=counter%> = 0;
	
	<% @cluster_sets.each_with_index {|set, index| %>		
		barchart_mentoring_<%=counter%>_<%=(index+1)%> = function()
		{
			<%= render_chart_without_script indicator_combo_chart(set,indicator,@collection_names,1300,500,'automatic',true,60), 'barchartb'+counter.to_s+'_'+index.to_s %>
		}
		$('#barchartb<%=counter.to_s%>_<%=index%>').toggle();
		<%= render_chart_without_script indicator_combo_chart(set,indicator,@collection_names,1300,500,'automatic',true,60), 'barchartb'+counter.to_s+'_'+index.to_s %>
		$('#barchartb<%=counter.to_s%>_<%=index%>').toggle();
	<% } %>

	scatterplot_mentoring_<%=(counter)%> = function()
	{
		<%= render_chart_without_script indicator_scatter_chart(@clusters,indicator, @collection_names), 'scatterb'+counter.to_s %>
	}
	
	$('#scatterb<%=counter.to_s%>').toggle();
	<%= render_chart_without_script indicator_scatter_chart(@clusters,indicator, @collection_names), 'scatterb'+counter.to_s %>
	$('#scatterb<%=counter.to_s%>').toggle();
<% counter += 1 %>
<% end %>